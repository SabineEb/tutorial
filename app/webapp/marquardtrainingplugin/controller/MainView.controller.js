sap.ui.define(["com/systemagmbh/marquardtrainingplugin/controller/BaseController","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/base/Log","sap/ui/core/format/DateFormat"],function(t,e,i,a,n){"use strict";var o=a.getLogger("testPlugin",a.Level.INFO);let s={};let r={get_sfcDetails:"sfc/v1/sfcdetail",get_materialDetails:"material/v2/materials"};return t.extend("com.systemagmbh.marquardtrainingplugin.controller.MainView",{onInit:function(){t.prototype.onInit.apply(this,arguments);s=this._getConfiguration();o.info("onInit - podConfig: "+JSON.stringify(s));this.getView().byId("startButtonId").setVisible(s.startButtonVisible);this.getView().byId("stopButtonId").setVisible(s.stopButtonVisible);this.getView().byId("backendCallButtonId").setVisible(s.backendCallButtonVisible);this.preloadData()},formatDateTime:function(t){var e=n.getDateTimeInstance({pattern:"dd.MM.yy HH:mm"});var i=new Date(t);var a=e.format(i);return a},updateView:function(){oData.items.push({id:1,startTime:formatDateTime(new Date),endTime:formatDateTime(new Date),material:this.getView().getModel("preloadData").getData().material});var t=new e(oData);this.getView().setModel(t,"dataFromTimeTracking")},updateStartTimeView:function(){if(this.getView().getModel("dataFromTimeTracking")!=undefined){var t=this.getView().getModel("dataFromTimeTracking").getData()}else{var t={items:[]}}t.items.push({id:1,startTime:this.formatDateTime(new Date),endTime:"",material:this.getView().getModel("preloadData").getData().data.material});var i=new e(t);this.getView().setModel(i,"dataFromTimeTracking")},updateStopTimeView:function(){if(this.getView().getModel("dataFromTimeTracking")!=undefined){var t=this.getView().getModel("dataFromTimeTracking").getData()}else{var t={items:[]}}t.items.push({id:1,endTime:this.formatDateTime(new Date),material:this.getView().getModel("preloadData").getData().data.material});var i=new e(t);this.getView().setModel(i,"dataFromTimeTracking")},pressStopTimeButton:function(){this.updateStopTimeView()},pressStartTimeButton:function(){this.updateStartTimeView()},pressBackendCallButton:function(){var t={plant:"PS_DEV",startDateTime:(new Date).toISOString(),endDateTime:(new Date).toISOString(),resourceId:"RESOURCE_1"};if(this.getPodController()!=undefined){var e=this.getPodController()._oPodController.getPeRestDataSourceUri()+"api/v1/process/processDefinitions/start?key="+s.key;this.getPodController()._oPodController.ajaxPostRequest(e,t,function(t){console.log(t)},function(t,e){var a=t||e;console.log(a);i.show("ERROR")})}else{i.show("PodController not found")}},preloadData:function(){this.getMaterialDetails()},getMaterialDetails:function(){this.get(r.get_materialDetails,{plant:this.getPlant(),material:this.getMaterial()}).then(t=>{var i={data:{material:this.getMaterial(),order:this.getOrder(),sfc:this.getSfc(),operation:"",materialStatus:t.content[0].status,lotSize:t.content[0].lotSize,materialType:t.content[0].materialType}};var a=new e(i);this.getView().setModel(a,"preloadData");o.info("getMaterialDetails - payload: "+JSON.stringify(i))}).catch(t=>{i.show("Error ="+t)})},onBeforeRenderingPlugin:function(){if(this.getPodController()){this.subscribe("PodSelectionChangeEvent",this.onPodSelectionChangeEvent,this);this.subscribe("OperationListSelectEvent",this.onOperationChangeEvent,this);this.subscribe("WorklistSelectEvent",this.onWorkListSelectEvent,this)}},onAfterRendering:function(){},onAfterPodConfigsLoad:function(t){},isSubscribingToNotifications:function(){var t=false;return t},getCustomNotificationEvents:function(t){},getNotificationMessageHandler:function(t){return null},_handleNotificationMessage:function(t){var e="Message not found in payload 'message' property";if(t&&t.parameters&&t.parameters.length>0){for(var i=0;i<t.parameters.length;i++){switch(t.parameters[i].name){case"template":break;case"template2":}}}},onBackButtonPress:function(t){i.show("Back Button Pressed!")},onExit:function(){if(t.prototype.onExit){t.prototype.onExit.apply(this,arguments)}this.unsubscribe("PodSelectionChangeEvent",this.onPodSelectionChangeEvent,this);this.unsubscribe("OperationListSelectEvent",this.onOperationChangeEvent,this);this.unsubscribe("WorklistSelectEvent",this.onWorkListSelectEvent,this)},onPodSelectionChangeEvent:function(t,e,i){o.info("onPodSelectionChangeEvent: -> "+i.selections)},onOperationChangeEvent:function(t,e,i){var a=this.getView().getModel("preloadData");var n=a.getData();n.data.operation=i.selections[0].operation;a.setData(n);o.info("onOperationChangeEvent: -> "+i.selections)},onWorkListSelectEvent:function(t,e,i){o.info("onWorkListSelectEvent: -> "+i.selections)}})});
//# sourceMappingURL=MainView.controller.js.map